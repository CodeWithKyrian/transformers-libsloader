name: Build Libsndfile

on:
  workflow_dispatch:
    inputs:
      version:
        description: 'Libsndfile Version to Build'
        required: true
        default: '1.0.31'
      platform:
        description: 'Platform to Build On'
        required: true
        default: 'all'
        type: choice
        options:
          - linux
          - windows
          - macos
          - all

jobs:
  build:
    strategy:
      matrix:
        platform: [ linux, windows, macos ]
        include:
          - platform: linux
            target_suffix: x86_64
          - platform: windows
            target_suffix: x64
          - platform: macos
            target_suffix: x86_64
      fail-fast: false
      max-parallel: 3

    runs-on: ${{ matrix.platform == 'linux' && 'ubuntu-latest' || matrix.platform == 'windows' && 'windows-latest' || 'macos-latest' }}
